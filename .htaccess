# =========================
# GluOne .htaccess (REG.RU)
# =========================

# Пробрасываем Authorization в PHP (если нужно)
SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1

# Отключаем угадывание расширений
Options -MultiViews
DirectoryIndex index.html

RewriteEngine On
RewriteBase /

# 1) Отдаём существующие файлы/папки как есть
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule . - [L]

# 2) Чистые URL → соответствующий .html
#    /privacy → /privacy.html (внутренне)
RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^(.+?)/?$ $1.html [L]

# 3) Старые ссылки с .html → без .html (SEO редирект)
#    /privacy.html → /privacy
RewriteCond %{THE_REQUEST} \s/+(.+?)\.html[?\s] [NC]
RewriteRule ^ %1 [R=301,L]

# =========================
# Политики: заголовки страниц
# Требуется mod_headers
# =========================
<IfModule mod_headers.c>

  # ---------- PRIVACY ----------
  <Files "privacy.html">
    Header set X-Policy-Slug "privacy"
    Header set X-Policy-Version "2025-09-16-v1"

    FileETag None
    Header set ETag "\"6149042b587c2f5ed34a80e2c2ea200adb9e75ddddd945315812a03dee97a698\""

    Header set Cache-Control "public, max-age=31536000, immutable"
    Header append Vary "Accept-Encoding"
  </Files>

  # ---------- CONSENT ----------
  <Files "consent.html">
    Header set X-Policy-Slug "consent"
    Header set X-Policy-Version "2025-09-16-v3"

    FileETag None
    Header set ETag "\"535cac1c51ce74eb9b528daee1e51dc58a101ff87f34a1331315b2952ccf58b0\""

    Header set Cache-Control "public, max-age=31536000, immutable"
    Header append Vary "Accept-Encoding"
  </Files>

  # ---------- TERMS ----------
  <Files "terms.html">
    Header set X-Policy-Slug "terms"
    Header set X-Policy-Version "2025-09-16-v1"

    FileETag None
    Header set ETag "\"78e5df4a389f05b42b879f020fd106e2ef8976dad0dd0c900ff20ee2cf287dca\""

    Header set Cache-Control "public, max-age=31536000, immutable"
    Header append Vary "Accept-Encoding"
  </Files>

  # ---------- OFFER ----------
  <Files "offer.html">
    Header set X-Policy-Slug "offer"
    Header set X-Policy-Version "2025-09-16-v1"

    FileETag None
    Header set ETag "\"bd815d928c81d52035e90b56126304be11f763cb5aed12bf6d52d5b75ce8e7f9\""

    Header set Cache-Control "public, max-age=31536000, immutable"
    Header append Vary "Accept-Encoding"
  </Files>

</IfModule>
