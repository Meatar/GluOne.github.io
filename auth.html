<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GluOne ‚Äî –≤—Ö–æ–¥</title>

  <meta name="description" content="–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ GluOne">
  <meta name="color-scheme" content="light dark">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0f172a">

  <!-- Tailwind (–∫–∞–∫ –∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- –¢–≤–æ–∏ –æ–±—â–∏–µ —Å—Ç–∏–ª–∏ -->
  <link rel="stylesheet" href="styles.css">
  <style>
    /* –ù–µ–±–æ–ª—å—à–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —à—Ç—Ä–∏—Ö–∏ –ø–æ–¥ —Ñ–æ—Ä–º—É */
    .card {
      background: var(--card, #ffffff);
      border: 1px solid color-mix(in oklab, var(--divider, #e5e7eb) 70%, transparent);
      box-shadow: var(--shadow-sm, 0 1px 2px rgba(0,0,0,.05)), var(--shadow-lg, 0 10px 30px rgba(2,6,23,.06));
    }
    .field { height: 48px; border-radius: 12px; }
    .field:focus { outline: none; box-shadow: 0 0 0 3px color-mix(in oklab, var(--ring,#6366f1) 35%, transparent); border-color: color-mix(in oklab, var(--ring,#6366f1) 50%, var(--divider,#e5e7eb)); }
    .eye-btn { position:absolute; right:8px; top:50%; transform:translateY(-50%); height:34px; min-width:36px; border-radius:10px; }
    .eye-btn:focus-visible { outline: none; box-shadow: 0 0 0 3px color-mix(in oklab, var(--ring,#6366f1) 35%, transparent); }
    .btn-primary { height:48px; border-radius:9999px; }
  </style>
</head>
<body class="bg-white text-slate-900 antialiased">
  <main class="min-h-screen grid place-items-center px-4 py-10">
    <section class="w-full max-w-md">
      <div class="card rounded-2xl p-6 sm:p-8">
        <div class="flex flex-col items-center text-center">
          <img src="assets/logo.png" alt="GluOne" class="h-10 w-10 rounded-xl mb-3">
          <h1 class="text-2xl font-extrabold tracking-tight">–í—Ö–æ–¥</h1>
          <p class="mt-1 text-slate-600 text-sm">–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å.</p>
        </div>

        <form id="authForm" class="mt-6" novalidate>
          <!-- –õ–æ–≥–∏–Ω -->
          <label for="login" class="block text-sm font-semibold text-slate-700">–õ–æ–≥–∏–Ω</label>
          <div class="relative mt-2">
            <input
              id="login"
              name="login"
              type="text"
              inputmode="latin"
              autocomplete="username"
              placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, alex_kiselev"
              class="field w-full px-3 border text-[16px] bg-white"
              required minlength="3" maxlength="64"
              pattern="^[A-Za-z0-9._-]+$"
              title="–¢–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, —Ç–æ—á–∫–∏, –¥–µ—Ñ–∏—Å—ã –∏ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è">
          </div>
          <p id="loginError" class="mt-1 text-sm text-rose-600 hidden"></p>

          <!-- –ü–∞—Ä–æ–ª—å -->
          <label for="password" class="block text-sm font-semibold text-slate-700 mt-4">–ü–∞—Ä–æ–ª—å</label>
          <div class="relative mt-2">
            <input
              id="password"
              name="password"
              type="password"
              autocomplete="current-password"
              placeholder="–í–∞—à –ø–∞—Ä–æ–ª—å"
              class="field w-full pr-12 px-3 border text-[16px] bg-white"
              required minlength="8" maxlength="72"
              pattern="^[\x21-\x7E]+$"
              title="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤, —Ç–æ–ª—å–∫–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã, –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤">
            <button type="button" id="togglePass" class="eye-btn px-2 border hover:bg-slate-50" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å">üëÅÔ∏è</button>
          </div>
          <p id="passwordError" class="mt-1 text-sm text-rose-600 hidden"></p>

          <div class="flex justify-end mt-2">
            <a href="/forgot" class="text-sm text-indigo-600 hover:underline">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
          </div>

          <button id="submitBtn" type="submit" class="btn-hero btn-primary w-full mt-5">–í–æ–π—Ç–∏</button>

          <p id="formMsg" class="mt-4 text-sm"></p>
        </form>
      </div>
    </section>
  </main>

  <script>
    // –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ –ø–∞—Ä–æ–ª—è
    const pass   = document.getElementById('password');
    const toggle = document.getElementById('togglePass');
    toggle.addEventListener('click', () => {
      const isPw = pass.type === 'password';
      pass.type = isPw ? 'text' : 'password';
      toggle.setAttribute('aria-label', isPw ? '–°–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å' : '–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å');
    });

    // –ü—Ä–æ—Å—Ç–∞—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
    const form   = document.getElementById('authForm');
    const btn    = document.getElementById('submitBtn');
    const msg    = document.getElementById('formMsg');
    const loginE = document.getElementById('loginError');
    const passE  = document.getElementById('passwordError');

    function showError(el, errEl){
      errEl.textContent = el.validationMessage || '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–æ–ª—è.';
      errEl.classList.remove('hidden');
      el.setAttribute('aria-invalid','true');
    }
    function clearError(el, errEl){
      errEl.textContent = '';
      errEl.classList.add('hidden');
      el.removeAttribute('aria-invalid');
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.textContent = ''; msg.className = 'mt-4 text-sm';

      // –°–±—Ä–æ—Å –æ—à–∏–±–æ–∫
      clearError(login, loginE);
      clearError(password, passE);

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª
      if(!login.checkValidity()){ showError(login, loginE); return; }
      if(!password.checkValidity()){ showError(password, passE); return; }

      // –ì–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ
      const payload = {
        login: login.value.trim(),
        password: password.value
      };

      // –°–∞–±–º–∏—Ç
      btn.disabled = true; btn.style.opacity = .7;
      try {
        // –í—Å—Ç–∞–≤—å —Å–≤–æ–π —Ä–µ–∞–ª—å–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç:
        // const res = await fetch('/api/auth/login', {
        //   method:'POST', headers:{'Content-Type':'application/json'},
        //   body: JSON.stringify(payload)
        // });
        // if(!res.ok) throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
        // const data = await res.json();

        // –ó–∞–≥–ª—É—à–∫–∞ —É—Å–ø–µ—Ö–∞:
        await new Promise(r => setTimeout(r, 500));
        msg.textContent = '–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º‚Ä¶';
        msg.classList.add('text-emerald-600');
        // window.location.href = (new URLSearchParams(location.search)).get('next') || '/';
      } catch (err){
        msg.textContent = err.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ–π—Ç–∏. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É.';
        msg.classList.add('text-rose-600');
      } finally {
        btn.disabled = false; btn.style.opacity = 1;
      }
    }, {passive:false});
  </script>
</body>
</html>
